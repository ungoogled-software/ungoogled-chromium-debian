Use system libicu
--- a/src/app/app.gyp
+++ b/src/app/app.gyp
@@ -30,8 +30,7 @@
         '../skia/skia.gyp:skia',
         '../testing/gmock.gyp:gmock',
         '../testing/gtest.gyp:gtest',
-        '../third_party/icu/icu.gyp:icui18n',
-        '../third_party/icu/icu.gyp:icuuc',
+        '../build/linux/system.gyp:icu',
         '../third_party/libjpeg/libjpeg.gyp:libjpeg',
         '../third_party/libpng/libpng.gyp:libpng',
         '../third_party/zlib/zlib.gyp:zlib',
--- a/src/app/app_base.gypi
+++ b/src/app/app_base.gypi
@@ -74,8 +74,7 @@
         '../gfx/gfx.gyp:gfx',
         '../net/net.gyp:net',
         '../skia/skia.gyp:skia',
-        '../third_party/icu/icu.gyp:icui18n',
-        '../third_party/icu/icu.gyp:icuuc',
+        '../build/linux/system.gyp:icu',
         '../third_party/libjpeg/libjpeg.gyp:libjpeg',
         '../third_party/libpng/libpng.gyp:libpng',
         '../third_party/sqlite/sqlite.gyp:sqlite',
--- a/src/base/base.gyp
+++ b/src/base/base.gyp
@@ -16,8 +16,7 @@
       'msvs_guid': '968F3222-9798-4D21-BE08-15ECB5EF2994',
       'dependencies': [
         'base',
-        '../third_party/icu/icu.gyp:icui18n',
-        '../third_party/icu/icu.gyp:icuuc',
+        '../build/linux/system.gyp:icu',
       ],
       'conditions': [
         ['OS=="linux" or OS=="freebsd" or OS=="openbsd"', {
@@ -161,7 +160,7 @@
       'include_dirs': [
         # word_iterator.h (used by word_iterator_unittest.cc) leaks an ICU
         # #include for unicode/uchar.h.  This should probably be cleaned up.
-        '../third_party/icu/public/common',
+        # '../third_party/icu/public/common',
       ],
       'dependencies': [
         'base',
--- a/src/build/all.gyp
+++ b/src/build/all.gyp
@@ -31,7 +31,6 @@
         '../third_party/cld/cld.gyp:*',
         '../third_party/codesighs/codesighs.gyp:*',
         '../third_party/ffmpeg/ffmpeg.gyp:*',
-        '../third_party/icu/icu.gyp:*',
         '../third_party/libjpeg/libjpeg.gyp:*',
         '../third_party/libpng/libpng.gyp:*',
         '../third_party/libxml/libxml.gyp:*',
--- a/src/build/linux/system.gyp
+++ b/src/build/linux/system.gyp
@@ -256,6 +256,26 @@
       }]]
     },
     {
+      'target_name': 'icu',
+      'type': 'settings',
+      'conditions': [
+        ['_toolset=="target"', {
+          'direct_dependent_settings': {
+            'cflags': [
+              '<!@()',
+            ],
+          },
+          'link_settings': {
+            'ldflags': [
+              '<!@(icu-config --ldflags)',
+            ],
+            'libraries': [
+              '<!@(icu-config --ldflags-libsonly)',
+            ],
+          },
+      }]]
+    },
+    {
       'target_name': 'gnome-keyring',
       'type': 'settings',
       'conditions': [
--- a/src/build/temp_gyp/googleurl.gyp
+++ b/src/build/temp_gyp/googleurl.gyp
@@ -14,9 +14,7 @@
       'msvs_guid': 'EF5E94AB-B646-4E5B-A058-52EF07B8351C',
       'dependencies': [
         '../../base/base.gyp:base',
-        '../../third_party/icu/icu.gyp:icudata',
-        '../../third_party/icu/icu.gyp:icui18n',
-        '../../third_party/icu/icu.gyp:icuuc',
+        '../../build/linux/system.gyp:icu',
       ],
       'sources': [
         '../../googleurl/src/gurl.cc',
@@ -66,7 +64,7 @@
       'dependencies': [
         'googleurl',
         '../../testing/gtest.gyp:gtest',
-        '../../third_party/icu/icu.gyp:icuuc',
+        '../../build/linux/system.gyp:icu',
       ],
       'sources': [
         '../../googleurl/src/gurl_unittest.cc',
--- a/src/chrome/chrome.gyp
+++ b/src/chrome/chrome.gyp
@@ -523,8 +523,8 @@
         '../net/net.gyp:http_listen_socket',
         'theme_resources',
         '../skia/skia.gyp:skia',
-        '../third_party/icu/icu.gyp:icui18n',
-        '../third_party/icu/icu.gyp:icuuc',
+        '../build/linux/system.gyp:icu',
+
       ],
       'include_dirs': [
         '..',
@@ -573,8 +573,7 @@
         'chrome_strings',
         '../media/media.gyp:media',
         '../skia/skia.gyp:skia',
-        '../third_party/icu/icu.gyp:icui18n',
-        '../third_party/icu/icu.gyp:icuuc',
+        '../build/linux/system.gyp:icu',
         '../third_party/npapi/npapi.gyp:npapi',
         '../third_party/hunspell/hunspell.gyp:hunspell',
         '../webkit/support/webkit_support.gyp:glue',
@@ -790,7 +789,7 @@
         '../base/base.gyp:base',
         '../build/temp_gyp/googleurl.gyp:googleurl',
         '../jingle/jingle.gyp:notifier',
-        '../third_party/icu/icu.gyp:icuuc',
+        '../build/linux/system.gyp:icu',
         '../third_party/libjingle/libjingle.gyp:libjingle',
         '../third_party/sqlite/sqlite.gyp:sqlite',
         'browser/sync/protocol/sync_proto.gyp:sync_proto_cpp',
--- a/src/chrome/chrome_browser.gypi
+++ b/src/chrome/chrome_browser.gypi
@@ -29,8 +29,7 @@
         '../skia/skia.gyp:skia',
         '../third_party/bzip2/bzip2.gyp:bzip2',
         '../third_party/expat/expat.gyp:expat',
-        '../third_party/icu/icu.gyp:icui18n',
-        '../third_party/icu/icu.gyp:icuuc',
+        '../build/linux/system.gyp:icu',
         '../third_party/libjingle/libjingle.gyp:libjingle',
         '../third_party/libxml/libxml.gyp:libxml',
         '../third_party/npapi/npapi.gyp:npapi',
--- a/src/chrome/chrome_renderer.gypi
+++ b/src/chrome/chrome_renderer.gypi
@@ -18,8 +18,7 @@
         '../skia/skia.gyp:skia',
         '../third_party/hunspell/hunspell.gyp:hunspell',
         '../third_party/cld/cld.gyp:cld',
-        '../third_party/icu/icu.gyp:icui18n',
-        '../third_party/icu/icu.gyp:icuuc',
+        '../build/linux/system.gyp:icu',
         '../third_party/npapi/npapi.gyp:npapi',
         '../third_party/WebKit/WebKit/chromium/WebKit.gyp:webkit',
         '../webkit/support/webkit_support.gyp:glue',
--- a/src/chrome/chrome_tests.gypi
+++ b/src/chrome/chrome_tests.gypi
@@ -267,8 +267,7 @@
         '../skia/skia.gyp:skia',
         '../testing/gmock.gyp:gmock',
         '../testing/gtest.gyp:gtest',
-        '../third_party/icu/icu.gyp:icui18n',
-        '../third_party/icu/icu.gyp:icuuc',
+        '../build/linux/system.gyp:icu',
         '../third_party/libxml/libxml.gyp:libxml',
         # run time dependencies
         'default_plugin/default_plugin.gyp:default_plugin',
@@ -441,8 +440,7 @@
         '../net/net.gyp:net',
         '../skia/skia.gyp:skia',
         '../testing/gtest.gyp:gtest',
-        '../third_party/icu/icu.gyp:icui18n',
-        '../third_party/icu/icu.gyp:icuuc',
+        '../build/linux/system.gyp:icu',
       ],
       'include_dirs': [
         '..',
@@ -521,8 +519,7 @@
         '../third_party/bzip2/bzip2.gyp:bzip2',
         '../third_party/cld/cld.gyp:cld',
         '../third_party/expat/expat.gyp:expat',
-        '../third_party/icu/icu.gyp:icui18n',
-        '../third_party/icu/icu.gyp:icuuc',
+        '../build/linux/system.gyp:icu',
         '../third_party/libjingle/libjingle.gyp:libjingle',
         '../third_party/libxml/libxml.gyp:libxml',
         '../third_party/npapi/npapi.gyp:npapi',
@@ -1325,8 +1322,7 @@
         '../skia/skia.gyp:skia',
         '../testing/gmock.gyp:gmock',
         '../testing/gtest.gyp:gtest',
-        '../third_party/icu/icu.gyp:icui18n',
-        '../third_party/icu/icu.gyp:icuuc',
+        '../build/linux/system.gyp:icu',
       ],
       'include_dirs': [
         '..',
@@ -1975,8 +1971,7 @@
         '../skia/skia.gyp:skia',
         '../testing/gmock.gyp:gmock',
         '../testing/gtest.gyp:gtest',
-        '../third_party/icu/icu.gyp:icui18n',
-        '../third_party/icu/icu.gyp:icuuc',
+        '../build/linux/system.gyp:icu',
         '../third_party/npapi/npapi.gyp:npapi',
         '../third_party/WebKit/WebKit/chromium/WebKit.gyp:webkit',
       ],
--- a/src/chrome/test/interactive_ui/interactive_ui_tests.gypi
+++ b/src/chrome/test/interactive_ui/interactive_ui_tests.gypi
@@ -15,7 +15,7 @@
     '<(DEPTH)/net/net.gyp:net_resources',
     '<(DEPTH)/net/net.gyp:net_test_support',
     '<(DEPTH)/skia/skia.gyp:skia',
-    '<(DEPTH)/third_party/icu/icu.gyp:icui18n',
+    '<(DEPTH)/build/linux/system.gyp:icu',
     '<(DEPTH)/third_party/libpng/libpng.gyp:libpng',
     '<(DEPTH)/third_party/zlib/zlib.gyp:zlib',
     '<(DEPTH)/testing/gtest.gyp:gtest',
--- a/src/chrome_frame/chrome_frame.gyp
+++ b/src/chrome_frame/chrome_frame.gyp
@@ -378,8 +378,7 @@
         '../net/net.gyp:net_test_support',
         '../skia/skia.gyp:skia',
         '../testing/gtest.gyp:gtest',
-        '../third_party/icu/icu.gyp:icui18n',
-        '../third_party/icu/icu.gyp:icuuc',
+        '../build/linux/system.gyp:icu',
         'chrome_frame_npapi',
         'chrome_frame_ie',
         'npchrome_frame',
--- a/src/gfx/gfx.gyp
+++ b/src/gfx/gfx.gyp
@@ -65,8 +65,7 @@
         '../base/base.gyp:base',
         '../base/base.gyp:base_i18n',
         '../skia/skia.gyp:skia',
-        '../third_party/icu/icu.gyp:icui18n',
-        '../third_party/icu/icu.gyp:icuuc',
+        '../build/linux/system.gyp:icu',
         '../third_party/libjpeg/libjpeg.gyp:libjpeg',
         '../third_party/libpng/libpng.gyp:libpng',
         '../third_party/sqlite/sqlite.gyp:sqlite',
--- a/src/net/net.gyp
+++ b/src/net/net.gyp
@@ -15,8 +15,7 @@
         '../base/base.gyp:base_i18n',
         '../build/temp_gyp/googleurl.gyp:googleurl',
         '../sdch/sdch.gyp:sdch',
-        '../third_party/icu/icu.gyp:icui18n',
-        '../third_party/icu/icu.gyp:icuuc',
+        '../build/linux/system.gyp:icu',
         '../third_party/zlib/zlib.gyp:zlib',
         'net_resources',
       ],
@@ -233,8 +232,7 @@
         '../base/base.gyp:base_i18n',
         '../build/temp_gyp/googleurl.gyp:googleurl',
         '../sdch/sdch.gyp:sdch',
-        '../third_party/icu/icu.gyp:icui18n',
-        '../third_party/icu/icu.gyp:icuuc',
+        '../build/linux/system.gyp:icu',
         '../third_party/zlib/zlib.gyp:zlib',
         'net_base',
         'net_resources',
--- a/src/printing/printing.gyp
+++ b/src/printing/printing.gyp
@@ -16,8 +16,7 @@
         '../base/base.gyp:base_i18n',
         '../build/temp_gyp/googleurl.gyp:googleurl',
         '../skia/skia.gyp:skia',
-        '../third_party/icu/icu.gyp:icui18n',
-        '../third_party/icu/icu.gyp:icuuc',
+        '../build/linux/system.gyp:icu',
       ],
       'msvs_guid': '9E5416B9-B91B-4029-93F4-102C1AD5CAF4',
       'include_dirs': [
--- a/src/third_party/WebKit/JavaScriptCore/JavaScriptCore.gyp/JavaScriptCore.gyp
+++ b/src/third_party/WebKit/JavaScriptCore/JavaScriptCore.gyp/JavaScriptCore.gyp
@@ -97,8 +97,7 @@
       'msvs_guid': 'AA8A5A85-592B-4357-BC60-E0E91E026AF6',
       'dependencies': [
         'wtf_config',
-        '<(chromium_src_dir)/third_party/icu/icu.gyp:icui18n',
-        '<(chromium_src_dir)/third_party/icu/icu.gyp:icuuc',
+        '<(chromium_src_dir)/build/linux/system.gyp:icu',
       ],
       'include_dirs': [
         '../',
@@ -128,8 +127,7 @@
       },
       'export_dependent_settings': [
         'wtf_config',
-        '<(chromium_src_dir)/third_party/icu/icu.gyp:icui18n',
-        '<(chromium_src_dir)/third_party/icu/icu.gyp:icuuc',
+        '<(chromium_src_dir)/build/linux/system.gyp:icu',
       ],
       'msvs_disabled_warnings': [4127, 4355, 4510, 4512, 4610, 4706],
       'conditions': [
--- a/src/third_party/cld/cld.gyp
+++ b/src/third_party/cld/cld.gyp
@@ -8,7 +8,7 @@
       'target_name': 'cld',
       'type': '<(library)',
       'dependencies': [
-      	'../icu/icu.gyp:icuuc',
+        '../../build/linux/system.gyp:icu',
       ],
       'include_dirs': [
         '.',
--- a/src/third_party/hunspell/hunspell.gyp
+++ b/src/third_party/hunspell/hunspell.gyp
@@ -10,7 +10,7 @@
       'msvs_guid': 'D5E8DCB2-9C61-446F-8BEE-B18CA0E0936E',
       'dependencies': [
         '../../base/base.gyp:base',
-        '../icu/icu.gyp:icuuc',
+        '../../build/linux/system.gyp:icu',
       ],
       'defines': [
         'HUNSPELL_STATIC',
--- a/src/third_party/libxml/libxml.gyp
+++ b/src/third_party/libxml/libxml.gyp
@@ -157,11 +157,11 @@
             'include',
           ],
           'dependencies': [
-            '../icu/icu.gyp:icuuc',
+            '../../build/linux/system.gyp:icu',
             '../zlib/zlib.gyp:zlib',
           ],
           'export_dependent_settings': [
-            '../icu/icu.gyp:icuuc',
+            '../../build/linux/system.gyp:icu',
           ],
           'direct_dependent_settings': {
             'defines': [
--- a/src/third_party/sqlite/sqlite.gyp
+++ b/src/third_party/sqlite/sqlite.gyp
@@ -205,8 +205,7 @@
             'src',
           ],
           'dependencies': [
-            '../icu/icu.gyp:icui18n',
-            '../icu/icu.gyp:icuuc',
+            '../../build/linux/system.gyp:icu',
           ],
           'direct_dependent_settings': {
             'include_dirs': [
@@ -234,7 +233,7 @@
           'target_name': 'sqlite_shell',
           'type': 'executable',
           'dependencies': [
-            '../icu/icu.gyp:icuuc',
+            '../../build/linux/system.gyp:icu',
             'sqlite',
           ],
           'sources': [
--- a/src/views/views.gyp
+++ b/src/views/views.gyp
@@ -43,8 +43,7 @@
         '../app/app.gyp:app_strings',
         '../app/app.gyp:app_resources',
         '../skia/skia.gyp:skia',
-        '../third_party/icu/icu.gyp:icui18n',
-        '../third_party/icu/icu.gyp:icuuc',
+        '../build/linux/system.gyp:icu',
       ],
       'sources': [
         # All .cc, .h under views, except unittests
@@ -377,8 +376,7 @@
       'dependencies': [
         '../base/base.gyp:base',
         '../skia/skia.gyp:skia',
-        '../third_party/icu/icu.gyp:icui18n',
-        '../third_party/icu/icu.gyp:icuuc',
+        '../build/linux/system.gyp:icu',
         'views',
       ],
       'include_dirs': [
--- a/src/webkit/tools/test_shell/test_shell.gypi
+++ b/src/webkit/tools/test_shell/test_shell.gypi
@@ -517,7 +517,7 @@
           'mac_bundle': 1,
           'msvs_guid': '0D04AEC1-6B68-492C-BCCF-808DFD69ABC6',
           'dependencies': [
-            '<(DEPTH)/third_party/icu/icu.gyp:icuuc',
+            '<(DEPTH)/build/linux/system.gyp:icu',
             'npapi_test_common',
           ],
           'sources': [
--- a/src/chrome/browser/autocomplete/autocomplete_popup_model.cc
+++ b/src/chrome/browser/autocomplete/autocomplete_popup_model.cc
@@ -11,7 +11,7 @@
 #include "chrome/browser/search_engines/template_url.h"
 #include "chrome/browser/search_engines/template_url_model.h"
 #include "chrome/common/notification_service.h"
-#include "third_party/icu/public/common/unicode/ubidi.h"
+#include <unicode/ubidi.h>
 
 ///////////////////////////////////////////////////////////////////////////////
 // AutocompletePopupModel
--- a/src/chrome/browser/views/autocomplete/autocomplete_popup_contents_view.cc
+++ b/src/chrome/browser/views/autocomplete/autocomplete_popup_contents_view.cc
@@ -22,7 +22,7 @@
 #include "grit/generated_resources.h"
 #include "grit/theme_resources.h"
 #include "third_party/skia/include/core/SkShader.h"
-#include "third_party/icu/public/common/unicode/ubidi.h"
+#include <unicode/ubidi.h>
 #include "views/widget/widget.h"
 
 #if defined(OS_WIN)
--- a/src/chrome/renderer/spellchecker/spellcheck_worditerator.cc
+++ b/src/chrome/renderer/spellchecker/spellcheck_worditerator.cc
@@ -12,10 +12,10 @@
 #include "base/basictypes.h"
 #include "base/utf_string_conversions.h"
 #include "chrome/renderer/spellchecker/spellcheck.h"
-#include "third_party/icu/public/common/unicode/normlzr.h"
-#include "third_party/icu/public/common/unicode/schriter.h"
-#include "third_party/icu/public/common/unicode/uscript.h"
-#include "third_party/icu/public/i18n/unicode/ulocdata.h"
+#include <unicode/normlzr.h>
+#include <unicode/schriter.h>
+#include <unicode/uscript.h>
+#include <unicode/ulocdata.h>
 
 // SpellcheckCharAttribute implementation:
 
--- a/src/chrome/renderer/spellchecker/spellcheck_worditerator.h
+++ b/src/chrome/renderer/spellchecker/spellcheck_worditerator.h
@@ -14,8 +14,8 @@
 
 #include "base/basictypes.h"
 #include "base/string16.h"
-#include "third_party/icu/public/common/unicode/ubrk.h"
-#include "third_party/icu/public/common/unicode/uscript.h"
+#include <unicode/ubrk.h>
+#include <unicode/uscript.h>
 
 // A class which encapsulates language-specific operations used by
 // SpellcheckWordIterator. When we set the spellchecker language, this class
--- a/src/chrome/chrome_common.gypi
+++ b/src/chrome/chrome_common.gypi
@@ -138,8 +138,7 @@
         '../net/net.gyp:net',
         '../skia/skia.gyp:skia',
         '../third_party/bzip2/bzip2.gyp:bzip2',
-        '../third_party/icu/icu.gyp:icui18n',
-        '../third_party/icu/icu.gyp:icuuc',
+        '../build/linux/system.gyp:icu',
         '../third_party/libxml/libxml.gyp:libxml',
         '../third_party/sqlite/sqlite.gyp:sqlite',
         '../third_party/zlib/zlib.gyp:zlib',
--- a/src/webkit/glue/webkit_glue.gypi
+++ b/src/webkit/glue/webkit_glue.gypi
@@ -113,8 +113,7 @@
         '<(DEPTH)/base/base.gyp:base_i18n',
         '<(DEPTH)/net/net.gyp:net',
         '<(DEPTH)/skia/skia.gyp:skia',
-        '<(DEPTH)/third_party/icu/icu.gyp:icui18n',
-        '<(DEPTH)/third_party/icu/icu.gyp:icuuc',
+        '<(DEPTH)/build/linux/system.gyp:icu',
         '<(DEPTH)/third_party/npapi/npapi.gyp:npapi',
         '<(DEPTH)/third_party/ppapi/ppapi.gyp:ppapi_c',
         'webkit_resources',
--- a/src/skia/skia.gyp
+++ b/src/skia/skia.gyp
@@ -597,7 +597,7 @@
             '../build/linux/system.gyp:freetype2',
             '../third_party/harfbuzz/harfbuzz.gyp:harfbuzz',
             '../third_party/harfbuzz/harfbuzz.gyp:harfbuzz_interface',
-            '../third_party/icu/icu.gyp:icuuc',
+            '../build/linux/system.gyp:icu',
           ],
           'cflags': [
             '-Wno-unused',
--- a/src/third_party/WebKit/WebKit/chromium/WebKit.gyp
+++ b/src/third_party/WebKit/WebKit/chromium/WebKit.gyp
@@ -611,7 +611,7 @@
                 'ImageDiff',
                 'webkit',
                 '../../JavaScriptCore/JavaScriptCore.gyp/JavaScriptCore.gyp:wtf_config',
-                '<(chromium_src_dir)/third_party/icu/icu.gyp:icuuc',
+                '<(chromium_src_dir)/build/linux/system.gyp:icu',
                 '<(chromium_src_dir)/webkit/support/webkit_support.gyp:npapi_layout_test_plugin',
                 '<(chromium_src_dir)/webkit/support/webkit_support.gyp:webkit_support',
                 '<(chromium_src_dir)/gpu/gpu.gyp:gles2_c_lib'
